<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–∑–∞—Ü—å–∫—ñ –•—Ä–æ–Ω—ñ–∫–∏ - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –í—ñ–π—Å—å–∫–æ–≤–æ–≥–æ –¢–æ–≤–∞—Ä–∏—à–∞</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --parchment: #f4e9d8;
            --old-paper: #e2d5c0;
            --ink-dark: #2c1810;
            --ink-light: #5d4037;
            --stain-brown: #8b4513;
            --stain-yellow: #d4a76a;
            --stain-tea: #b08d57;
            --cossack-blue: #0057b7;
            --cossack-yellow: #ffd700;
            --blood-red: #8b0000;
            --gold: #daa520;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #2a1c13;
            color: var(--ink-dark);
            padding: 20px;
            min-height: 100vh;
            font-family: 'Cinzel', serif;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(139, 69, 19, 0.15) 1px, transparent 1px),
                radial-gradient(circle at 90% 80%, rgba(139, 69, 19, 0.1) 1px, transparent 1px);
            background-size: 40px 40px, 60px 60px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--old-paper);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--stain-brown);
            border-radius: 4px;
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —É —Å—Ç–∏–ª—ñ —Å—Ç–∞—Ä–æ—ó –∫–æ–∑–∞—Ü—å–∫–æ—ó —Ö—Ä–æ–Ω—ñ–∫–∏ */
        .chronicle-title {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background-color: var(--parchment);
            border: 3px double var(--stain-brown);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            position: relative;
            overflow: hidden;
            border-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cpath d='M0,0 L100,0 L100,100 L0,100 Z' fill='none' stroke='%238b4513' stroke-width='3' stroke-dasharray='10,5'/%3E%3C/svg%3E") 30 round;
        }
        
        .chronicle-title::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(90deg, transparent 95%, rgba(139, 69, 19, 0.1) 100%),
                linear-gradient(0deg, rgba(0, 87, 183, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 215, 0, 0.05) 1px, transparent 1px);
            background-size: 100% 100%, 20px 100%, 100% 20px;
            pointer-events: none;
        }
        
        .title-main {
            font-family: 'UnifrakturCook', cursive;
            font-size: 4rem;
            color: var(--ink-dark);
            letter-spacing: 3px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
            margin-bottom: 10px;
            line-height: 1.1;
        }
        
        .title-main::first-letter {
            font-size: 5.5rem;
            color: var(--blood-red);
            text-shadow: 3px 3px 0 var(--stain-brown);
        }
        
        .title-sub {
            font-size: 1.8rem;
            color: var(--ink-light);
            font-style: italic;
            margin-top: 10px;
            position: relative;
            z-index: 1;
            letter-spacing: 1px;
        }
        
        .cossack-trident {
            font-size: 3rem;
            color: var(--cossack-blue);
            margin: 0 15px;
            text-shadow: 1px 1px 0 var(--cossack-yellow);
        }
        
        .paper-stain {
            position: absolute;
            border-radius: 50%;
            opacity: 0.08;
            z-index: 0;
            filter: blur(2px);
        }
        
        .stain-1 {
            width: 200px;
            height: 200px;
            background-color: var(--stain-tea);
            top: -80px;
            right: -50px;
            transform: rotate(15deg);
        }
        
        .stain-2 {
            width: 150px;
            height: 150px;
            background-color: var(--stain-brown);
            bottom: -50px;
            left: 10%;
            transform: rotate(-10deg);
        }
        
        .stain-3 {
            width: 120px;
            height: 120px;
            background-color: var(--stain-yellow);
            top: 30%;
            left: -40px;
        }
        
        .character-sheet {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .sheet-section {
            background-color: var(--parchment);
            padding: 25px;
            border: 2px solid var(--stain-brown);
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
            min-height: 300px;
            border-radius: 2px;
        }
        
        .sheet-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--cossack-blue), var(--cossack-yellow), var(--cossack-blue));
        }
        
        .section-title {
            font-size: 1.8rem;
            border-bottom: 2px solid var(--stain-brown);
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: var(--ink-dark);
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            text-transform: uppercase;
            position: relative;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background-color: var(--cossack-blue);
        }
        
        .section-title i {
            color: var(--blood-red);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--ink-light);
            font-size: 1.1rem;
            font-family: 'Cinzel', serif;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            color: var(--ink-dark);
            font-size: 1rem;
            border-radius: 3px;
            font-family: 'Cinzel', serif;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--cossack-blue);
            box-shadow: 0 0 0 2px rgba(0, 87, 183, 0.2);
        }
        
        input:read-only, input.locked {
            background-color: #f0e6d5;
            color: var(--ink-light);
            cursor: not-allowed;
            border-color: #a0522d;
            font-style: italic;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.5;
        }
        
        /* –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–æ–∑–∞–∫–∞ */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-box {
            background-color: var(--old-paper);
            border: 2px solid var(--stain-brown);
            padding: 15px;
            text-align: center;
            border-radius: 5px;
            position: relative;
            transition: all 0.3s;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-color: var(--cossack-blue);
        }
        
        .stat-name {
            font-size: 1rem;
            font-weight: bold;
            color: var(--blood-red);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--ink-dark);
            margin: 10px 0;
            font-family: 'Cinzel', serif;
        }
        
        .stat-modifier {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--blood-red);
            color: var(--parchment);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .roll-btn {
            background: linear-gradient(to bottom, var(--stain-brown), #5d2906);
            color: var(--parchment);
            border: none;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 0.9rem;
            margin-top: 5px;
            transition: all 0.3s;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid #5d2906;
        }
        
        .roll-btn:hover {
            background: linear-gradient(to bottom, #a0522d, var(--stain-brown));
            transform: translateY(-2px);
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* HP —Ç–∞ —Ä—ñ–≤–µ–Ω—å */
        .hp-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(to right, var(--old-paper), #e8dfca);
            padding: 15px;
            border: 2px solid var(--stain-brown);
            border-radius: 5px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .hp-display::before {
            content: "‚öî";
            position: absolute;
            top: 5px;
            left: 5px;
            font-size: 1.5rem;
            color: rgba(139, 0, 0, 0.1);
        }
        
        .hp-display::after {
            content: "üõ°";
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 1.5rem;
            color: rgba(139, 0, 0, 0.1);
        }
        
        .hp-info {
            display: flex;
            flex-direction: column;
        }
        
        .hp-label {
            font-size: 0.9rem;
            color: var(--ink-light);
            margin-bottom: 5px;
        }
        
        .hp-value {
            font-size: 2.8rem;
            font-weight: bold;
            color: var(--blood-red);
            line-height: 1;
        }
        
        .hp-max {
            font-size: 1rem;
            color: var(--ink-light);
            margin-top: 5px;
        }
        
        .level-badge {
            background: linear-gradient(135deg, var(--cossack-blue), #003d82);
            color: var(--cossack-yellow);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid var(--cossack-yellow);
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è HP */
        .hp-controls {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .hp-btn {
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            padding: 8px;
            cursor: pointer;
            border-radius: 3px;
            text-align: center;
            transition: all 0.3s;
            font-family: 'Cinzel', serif;
            font-weight: bold;
        }
        
        .hp-btn:hover {
            background-color: var(--stain-yellow);
            transform: translateY(-2px);
        }
        
        .hp-btn:nth-child(1), .hp-btn:nth-child(2) {
            color: var(--blood-red);
        }
        
        .hp-btn:nth-child(3), .hp-btn:nth-child(4) {
            color: #2e7d32;
        }
        
        .hp-btn:nth-child(5) {
            background: linear-gradient(to right, #2e7d32, #4caf50);
            color: white;
            border-color: #2e7d32;
        }
        
        /* –°–∏—Å—Ç–µ–º–∞ —Å–ª–∞–≤–∏ (XP) */
        .fame-container {
            margin-top: 20px;
        }
        
        .fame-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .fame-bar {
            height: 25px;
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
            position: relative;
        }
        
        .fame-bar::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 49%, rgba(0, 87, 183, 0.1) 50%, transparent 51%);
            background-size: 20px 100%;
        }
        
        .fame-progress {
            height: 100%;
            background: linear-gradient(to right, var(--cossack-blue), #0077cc);
            width: 0%;
            transition: width 1s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--cossack-yellow);
            font-weight: bold;
            position: relative;
            z-index: 1;
        }
        
        .fame-add-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .fame-add-btn {
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            padding: 8px;
            cursor: pointer;
            border-radius: 3px;
            text-align: center;
            transition: all 0.3s;
            font-family: 'Cinzel', serif;
        }
        
        .fame-add-btn:hover {
            background-color: var(--stain-yellow);
            transform: translateY(-2px);
        }
        
        /* –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫—É–±–∏–∫—ñ–≤ (–∫–æ—Å—Ç–∏) */
        .dice-roller {
            background-color: var(--parchment);
            padding: 25px;
            border: 2px solid var(--stain-brown);
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.4);
            margin-top: 30px;
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }
        
        .dice-roller::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--cossack-yellow), var(--cossack-blue), var(--cossack-yellow));
        }
        
        .dice-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .dice-select {
            flex: 1;
            min-width: 150px;
        }
        
        .roll-dice-btn {
            background: linear-gradient(to bottom, var(--cossack-blue), #003d82);
            color: var(--cossack-yellow);
            border: 2px solid var(--cossack-yellow);
            padding: 12px 25px;
            font-size: 1.2rem;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Cinzel', serif;
            font-weight: bold;
        }
        
        .roll-dice-btn:hover {
            background: linear-gradient(to bottom, #0066cc, var(--cossack-blue));
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 87, 183, 0.4);
        }
        
        .dice-result {
            font-size: 2.2rem;
            text-align: center;
            margin: 20px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            color: var(--blood-red);
            background-color: var(--old-paper);
            border: 2px dashed var(--stain-brown);
            border-radius: 5px;
            padding: 15px;
        }
        
        .dice-animation {
            font-size: 3rem;
            animation: diceRoll 1s infinite;
            color: var(--cossack-blue);
        }
        
        @keyframes diceRoll {
            0% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(90deg) scale(1.1); }
            50% { transform: rotate(180deg) scale(1); }
            75% { transform: rotate(270deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }
        
        /* –®–≤–∏–¥–∫—ñ –∫–Ω–æ–ø–∫–∏ –∫–∏–¥–∫—ñ–≤ */
        .quick-dice-buttons {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .quick-dice-btn {
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            padding: 10px;
            cursor: pointer;
            border-radius: 3px;
            text-align: center;
            transition: all 0.3s;
            font-family: 'Cinzel', serif;
            font-weight: bold;
        }
        
        .quick-dice-btn:hover {
            background-color: var(--stain-yellow);
            transform: translateY(-2px);
        }
        
        /* –Ü—Å—Ç–æ—Ä—ñ—è –∫–∏–¥–∫—ñ–≤ */
        .dice-history {
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            border-radius: 3px;
        }
        
        .dice-history-item {
            padding: 8px;
            border-bottom: 1px dashed var(--stain-brown);
            font-family: 'Cinzel', serif;
        }
        
        .dice-history-item:last-child {
            border-bottom: none;
        }
        
        /* –õ–æ–≥ –±–∏—Ç–≤ */
        .battle-log {
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background-color: var(--old-paper);
            border: 1px solid var(--stain-brown);
            border-radius: 3px;
        }
        
        .battle-log-item {
            padding: 8px;
            border-bottom: 1px dashed var(--stain-brown);
            display: flex;
            justify-content: space-between;
            font-family: 'Cinzel', serif;
        }
        
        .battle-log-item:last-child {
            border-bottom: none;
        }
        
        .battle-damage {
            color: var(--blood-red);
            font-weight: bold;
        }
        
        .battle-heal {
            color: #2e7d32;
            font-weight: bold;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –¥—ñ–π */
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .action-btn {
            padding: 14px 28px;
            font-size: 1.1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .save-btn {
            background: linear-gradient(to bottom, #2e7d32, #1b5e20);
            color: white;
            border: 2px solid #4caf50;
        }
        
        .load-btn {
            background: linear-gradient(to bottom, #1565c0, #0d47a1);
            color: white;
            border: 2px solid #42a5f5;
        }
        
        .share-btn {
            background: linear-gradient(to bottom, #ff8f00, #ef6c00);
            color: white;
            border: 2px solid #ffb74d;
        }
        
        .generate-btn {
            background: linear-gradient(to bottom, #5d4037, #3e2723);
            color: white;
            border: 2px solid #8d6e63;
        }
        
        .reset-btn {
            background: linear-gradient(to bottom, #c62828, #b71c1c);
            color: white;
            border: 2px solid #ef5350;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ñ –≤—ñ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: var(--parchment);
            padding: 30px;
            border-radius: 5px;
            width: 90%;
            max-width: 500px;
            border: 3px double var(--stain-brown);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            position: relative;
            font-family: 'Cinzel', serif;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--blood-red);
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: rotate(90deg);
        }
        
        /* –ö–æ–∑–∞—Ü—å–∫–∞ –ø–µ—á–∞—Ç–∫–∞ */
        .cossack-seal {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--cossack-yellow), #daa520);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--cossack-blue);
            font-size: 2.2rem;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            opacity: 0.8;
            border: 3px solid var(--cossack-blue);
        }
        
        .locked-seal {
            position: absolute;
            top: 15px;
            right: 15px;
            color: var(--blood-red);
            font-size: 1.8rem;
        }
        
        /* –¢–æ—Å—Ç–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(to right, var(--cossack-blue), #003d82);
            color: var(--cossack-yellow);
            padding: 15px 25px;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
            animation: fadeIn 0.5s, fadeOut 0.5s 2.5s;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            border: 2px solid var(--cossack-yellow);
            max-width: 400px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(20px); }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
        @media (max-width: 992px) {
            .title-main {
                font-size: 3rem;
            }
            
            .title-main::first-letter {
                font-size: 4rem;
            }
            
            .character-sheet {
                grid-template-columns: 1fr;
            }
            
            .quick-dice-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .hp-controls, .fame-add-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .title-main {
                font-size: 2.5rem;
            }
            
            .title-sub {
                font-size: 1.4rem;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .dice-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .cossack-seal {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .hp-controls, .fame-add-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .title-main {
                font-size: 2rem;
            }
            
            .title-sub {
                font-size: 1.2rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .action-btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .hp-controls, .fame-add-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —É —Å—Ç–∏–ª—ñ –∫–æ–∑–∞—Ü—å–∫–æ—ó —Ö—Ä–æ–Ω—ñ–∫–∏ -->
        <div class="chronicle-title">
            <div class="paper-stain stain-1"></div>
            <div class="paper-stain stain-2"></div>
            <div class="paper-stain stain-3"></div>
            
            <h1 class="title-main">
                <span>–ö–æ–∑–∞—Ü—å–∫—ñ</span>
                <span class="cossack-trident">‚öî</span>
                <span>–•—Ä–æ–Ω—ñ–∫–∏</span>
            </h1>
            <h2 class="title-sub">–†–µ—î—Å—Ç—Ä –í—ñ–π—Å—å–∫–æ–≤–æ–≥–æ –¢–æ–≤–∞—Ä–∏—à–∞ –ó–∞–ø–æ—Ä–æ–∑—å–∫–æ–≥–æ</h2>
        </div>
        
        <!-- –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ–∑–∞–∫–∞ -->
        <div class="character-sheet">
            <!-- –û—Å–æ–±–∏—Å—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∫–æ–∑–∞–∫–∞ -->
            <div class="sheet-section">
                <div class="locked-seal" id="name-lock" style="display: none;">
                    <i class="fas fa-lock"></i>
                </div>
                <div class="cossack-seal" id="character-final-seal" style="display: none;">
                    <i class="fas fa-shield-alt"></i>
                </div>
                
                <div class="section-title">
                    <span>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –¢–æ–≤–∞—Ä–∏—à–∞</span>
                    <i class="fas fa-scroll"></i>
                </div>
                <div class="form-group">
                    <label for="character-name">–Ü–º'—è —Ç–∞ –ü—Ä—ñ–∑–≤–∏—â–µ *</label>
                    <input type="text" id="character-name" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ –∫–æ–∑–∞–∫–∞" class="name-input">
                    <small style="color: var(--ink-light); font-size: 0.9rem; display: block; margin-top: 5px;">
                        <i class="fas fa-exclamation-circle"></i> –ü—ñ—Å–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –¥–æ —Ä–µ—î—Å—Ç—Ä—É —ñ–º'—è –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏
                    </small>
                </div>
                <div class="form-group">
                    <label for="character-class">–ó–≤–∞–Ω–Ω—è —Ç–∞ –ü–æ—Å–∞–¥–∞</label>
                    <select id="character-class">
                        <option value="">–í–∏–±–µ—Ä—ñ—Ç—å –∑–≤–∞–Ω–Ω—è</option>
                        <option value="–ö–æ–∑–∞–∫">–ö–æ–∑–∞–∫</option>
                        <option value="–û—Ç–∞–º–∞–Ω">–û—Ç–∞–º–∞–Ω</option>
                        <option value="–°–æ—Ç–Ω–∏–∫">–°–æ—Ç–Ω–∏–∫</option>
                        <option value="–ü–æ–ª–∫–æ–≤–Ω–∏–∫">–ü–æ–ª–∫–æ–≤–Ω–∏–∫</option>
                        <option value="–ì–µ—Ç—å–º–∞–Ω">–ì–µ—Ç—å–º–∞–Ω</option>
                        <option value="–ü–∏—Å–∞—Ä">–ü–∏—Å–∞—Ä</option>
                        <option value="–û—Å–∞–≤—É–ª">–û—Å–∞–≤—É–ª</option>
                        <option value="–•–æ—Ä—É–Ω–∂–∏–π">–•–æ—Ä—É–Ω–∂–∏–π</option>
                        <option value="–ó–Ω–∞—Ç–Ω–∏–π –í—ñ–π—Å—å–∫–æ–≤–∏–π –¢–æ–≤–∞—Ä–∏—à">–ó–Ω–∞—Ç–Ω–∏–π –í—ñ–π—Å—å–∫–æ–≤–∏–π –¢–æ–≤–∞—Ä–∏—à</option>
                        <option value="–î–∂—É—Ä–∞">–î–∂—É—Ä–∞ (–º–æ–ª–æ–¥–∏–π –∫–æ–∑–∞–∫)</option>
                        <option value="–ö—É—Ä—ñ–Ω–Ω–∏–π">–ö—É—Ä—ñ–Ω–Ω–∏–π</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="character-race">–ü–æ—Ö–æ–¥–∂–µ–Ω–Ω—è</label>
                    <select id="character-race">
                        <option value="">–í–∏–±–µ—Ä—ñ—Ç—å –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è</option>
                        <option value="–£–∫—Ä–∞—ó–Ω–µ—Ü—å">–£–∫—Ä–∞—ó–Ω–µ—Ü—å</option>
                        <option value="–ü–æ–ª—è–∫">–ü–æ–ª—è–∫</option>
                        <option value="–ú–æ–ª–¥–∞–≤–∞–Ω–∏–Ω">–ú–æ–ª–¥–∞–≤–∞–Ω–∏–Ω</option>
                        <option value="–¢–∞—Ç–∞—Ä–∏–Ω">–¢–∞—Ç–∞—Ä–∏–Ω</option>
                        <option value="–¢—É—Ä–æ–∫">–¢—É—Ä–æ–∫</option>
                        <option value="–í—ñ—Ä–º–µ–Ω–∏–Ω">–í—ñ—Ä–º–µ–Ω–∏–Ω</option>
                        <option value="–Ñ–≤—Ä–µ–π">–Ñ–≤—Ä–µ–π</option>
                        <option value="–ì—Ä–µ–∫">–ì—Ä–µ–∫</option>
                        <option value="–°–µ—Ä–±">–°–µ—Ä–±</option>
                        <option value="–ù—ñ–º–µ—Ü—å">–ù—ñ–º–µ—Ü—å</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="character-background">–ñ–∏—Ç—Ç—î–ø–∏—Å —Ç–∞ –ü–æ–¥–≤–∏–≥–∏</label>
                    <textarea id="character-background" placeholder="–û–ø–∏—à—ñ—Ç—å –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, –ø–æ–¥–≤–∏–≥–∏ —Ç–∞ –∂–∏—Ç—Ç—î–≤–∏–π —à–ª—è—Ö –∫–æ–∑–∞–∫–∞..."></textarea>
                </div>
            </div>
            
            <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–∞ –∑–¥–æ—Ä–æ–≤'—è -->
            <div class="sheet-section">
                <div class="section-title">
                    <span>–í—ñ–π—Å—å–∫–æ–≤—ñ –Ø–∫–æ—Å—Ç—ñ</span>
                    <i class="fas fa-fist-raised"></i>
                </div>
                
                <div class="hp-display">
                    <div class="hp-info">
                        <div class="hp-label">–ñ–∏—Ç—Ç—î–≤–∞ –°–∏–ª–∞</div>
                        <div class="hp-value" id="hp-value">45</div>
                        <div class="hp-max">–ó <span id="max-hp-value">45</span> –º–æ–∂–ª–∏–≤–∏—Ö</div>
                    </div>
                    <div class="level-badge" id="level-badge">–î–æ—Å–≤—ñ–¥: –ù–æ–≤–∞–∫</div>
                </div>
                
                <div class="hp-controls">
                    <div class="hp-btn" onclick="changeHP(-1)">–ü–æ—Ä–∞–Ω–µ–Ω–Ω—è -1</div>
                    <div class="hp-btn" onclick="changeHP(-5)">–í–∞–∂–∫–µ –ø–æ—Ä–∞–Ω–µ–Ω–Ω—è -5</div>
                    <div class="hp-btn" onclick="changeHP(1)">–õ—ñ–∫—É–≤–∞–Ω–Ω—è +1</div>
                    <div class="hp-btn" onclick="changeHP(5)">–ó–Ω–∞—á–Ω–µ –ª—ñ–∫—É–≤–∞–Ω–Ω—è +5</div>
                    <div class="hp-btn" onclick="healFull()">–ü–æ–≤–Ω–µ –æ–¥—É–∂–∞–Ω–Ω—è</div>
                </div>
                
                <!-- –°–∏—Å—Ç–µ–º–∞ —Å–ª–∞–≤–∏ (–∑–∞–º—ñ—Å—Ç—å XP) -->
                <div class="fame-container">
                    <div class="fame-info">
                        <span>–°–ª–∞–≤–∞ –ö–æ–∑–∞—Ü—å–∫–∞: <span id="current-fame">0</span> / <span id="required-fame">50</span></span>
                        <span id="fame-percentage">0%</span>
                    </div>
                    <div class="fame-bar" onclick="addFame(10)">
                        <div class="fame-progress" id="fame-progress" style="width: 0%;">0%</div>
                    </div>
                    <div class="fame-add-buttons">
                        <div class="fame-add-btn" onclick="addFame(5)">–ú–∞–ª–∞ –ø–µ—Ä–µ–º–æ–≥–∞ +5</div>
                        <div class="fame-add-btn" onclick="addFame(10)">–ü–µ—Ä–µ–º–æ–≥–∞ +10</div>
                        <div class="fame-add-btn" onclick="addFame(25)">–í–µ–ª–∏–∫–∞ –ø–µ—Ä–µ–º–æ–≥–∞ +25</div>
                        <div class="fame-add-btn" onclick="addFame(50)">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∏–π –ø–æ–¥–≤–∏–≥ +50</div>
                    </div>
                </div>
                
                <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–æ–∑–∞–∫–∞ -->
                <div class="stats-container">
                    <div class="stat-box">
                        <div class="stat-name">–ú—ñ—Ü—å</div>
                        <div class="stat-value" id="strength-value">10</div>
                        <div class="stat-modifier" id="strength-mod">+0</div>
                        <button class="roll-btn" onclick="rollStat('strength')">–ö–∏–Ω—É—Ç–∏ 3–∫6</button>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-name">–°–ø—Ä–∏—Ç–Ω—ñ—Å—Ç—å</div>
                        <div class="stat-value" id="dexterity-value">10</div>
                        <div class="stat-modifier" id="dexterity-mod">+0</div>
                        <button class="roll-btn" onclick="rollStat('dexterity')">–ö–∏–Ω—É—Ç–∏ 3–∫6</button>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-name">–†–æ–∑—É–º</div>
                        <div class="stat-value" id="intelligence-value">10</div>
                        <div class="stat-modifier" id="intelligence-mod">+0</div>
                        <button class="roll-btn" onclick="rollStat('intelligence')">–ö–∏–Ω—É—Ç–∏ 3–∫6</button>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-name">–ú—É–¥—Ä—ñ—Å—Ç—å</div>
                        <div class="stat-value" id="wisdom-value">10</div>
                        <div class="stat-modifier" id="wisdom-mod">+0</div>
                        <button class="roll-btn" onclick="rollStat('wisdom')">–ö–∏–Ω—É—Ç–∏ 3–∫6</button>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-name">–•–æ—Ä–æ–±—Ä—ñ—Å—Ç—å</div>
                        <div class="stat-value" id="charisma-value">10</div>
                        <div class="stat-modifier" id="charisma-mod">+0</div>
                        <button class="roll-btn" onclick="rollStat('charisma')">–ö–∏–Ω—É—Ç–∏ 3–∫6</button>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-name">–í–∏—Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å</div>
                        <div class="stat-value" id="constitution-value">10</div>
                        <div class="stat-modifier" id="constitution-mod">+0</div>
                        <button class="roll-btn" onclick="rollStat('constitution')">–ö–∏–Ω—É—Ç–∏ 3–∫6</button>
                    </div>
                </div>
            </div>
            
            <!-- –°–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è —Ç–∞ –Ω–∞–≤–∏—á–∫–∏ -->
            <div class="sheet-section">
                <div class="section-title">
                    <span>–°–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è —Ç–∞ –í–º—ñ–Ω–Ω—è</span>
                    <i class="fas fa-horse"></i>
                </div>
                <div class="form-group">
                    <label for="inventory">–ó–±—Ä–æ—è —Ç–∞ –û–±–ª–∞–¥—É–Ω–∫–∏</label>
                    <textarea id="inventory" placeholder="–û–ø–∏—à—ñ—Ç—å –∑–±—Ä–æ—é, –æ–±–ª–∞–¥—É–Ω–∫–∏ —Ç–∞ —Å–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è –∫–æ–∑–∞–∫–∞..."></textarea>
                </div>
                <div class="form-group">
                    <label for="skills">–í—ñ–π—Å—å–∫–æ–≤—ñ –í–º—ñ–Ω–Ω—è</label>
                    <textarea id="skills" placeholder="–û–ø–∏—à—ñ—Å—Ç—å –±–æ–π–æ–≤—ñ —Ç–∞ —ñ–Ω—à—ñ –≤–º—ñ–Ω–Ω—è –∫–æ–∑–∞–∫–∞..."></textarea>
                </div>
                <div class="form-group">
                    <label for="buffs">–û—Å–æ–±–ª–∏–≤—ñ –Ø–∫–æ—Å—Ç—ñ —Ç–∞ –ü—Ä–∏–≤—ñ–ª–µ—ó</label>
                    <textarea id="buffs" placeholder="–û–ø–∏—à—ñ—Ç—å –æ—Å–æ–±–ª–∏–≤—ñ —è–∫–æ—Å—Ç—ñ, –ø—Ä–∏–≤—ñ–ª–µ—ó —Ç–∞ –∑–≤'—è–∑–∫–∏ –∫–æ–∑–∞–∫–∞..."></textarea>
                </div>
                
                <!-- –õ–æ–≥ –±–∏—Ç–≤ -->
                <div class="battle-log">
                    <div style="font-weight: bold; margin-bottom: 10px; text-align: center; color: var(--blood-red);">
                        <i class="fas fa-swords"></i> –•—Ä–æ–Ω—ñ–∫–∞ –ë–æ–π–æ–≤–∏—Ö –î—ñ–π
                    </div>
                    <div id="battle-log-content">
                        <div class="battle-log-item">
                            <span>–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω</span>
                            <span class="battle-heal">45 –ñ–∏—Ç—Ç—î–≤–æ—ó –°–∏–ª–∏</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ö—ñ—Å—Ç–∫–∏ –¥–æ–ª—ñ (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫—É–±–∏–∫—ñ–≤) -->
        <div class="dice-roller">
            <div class="section-title">
                <span>–ö—ñ—Å—Ç–∫–∏ –î–æ–ª—ñ</span>
                <i class="fas fa-dice"></i>
            </div>
            
            <div class="dice-controls">
                <div class="dice-select">
                    <label for="dice-type">–¢–∏–ø –∫—ñ—Å—Ç–∫–∏</label>
                    <select id="dice-type">
                        <option value="4">–∫4</option>
                        <option value="6">–∫6</option>
                        <option value="8">–∫8</option>
                        <option value="10">–∫10</option>
                        <option value="12">–∫12</option>
                        <option value="20" selected>–∫20 (–ö—ñ—Å—Ç–∫–∞ –î–æ–ª—ñ)</option>
                        <option value="100">–∫100</option>
                    </select>
                </div>
                
                <div class="dice-select">
                    <label for="dice-count">–ö—ñ–ª—å–∫—ñ—Å—Ç—å</label>
                    <select id="dice-count">
                        <option value="1">1 –∫—ñ—Å—Ç–∫–∞</option>
                        <option value="2">2 –∫—ñ—Å—Ç–∫–∏</option>
                        <option value="3">3 –∫—ñ—Å—Ç–∫–∏</option>
                        <option value="4">4 –∫—ñ—Å—Ç–∫–∏</option>
                        <option value="5">5 –∫—ñ—Å—Ç–æ–∫</option>
                    </select>
                </div>
                
                <div class="dice-select">
                    <label for="modifier">–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä</label>
                    <input type="number" id="modifier" value="0" min="-10" max="50">
                </div>
                
                <button class="roll-dice-btn" onclick="rollDice()">
                    <i class="fas fa-dice-d20"></i> –ö–∏–Ω—É—Ç–∏ –ö—ñ—Å—Ç–∫–∏
                </button>
            </div>
            
            <!-- –®–≤–∏–¥–∫—ñ –∫–Ω–æ–ø–∫–∏ –∫–∏–¥–∫—ñ–≤ -->
            <div class="quick-dice-buttons">
                <div class="quick-dice-btn" onclick="quickRoll('–∫20', 1, 0)">–∫20</div>
                <div class="quick-dice-btn" onclick="quickRoll('–∫20', 2, 0)">2–∫20</div>
                <div class="quick-dice-btn" onclick="quickRoll('–∫6', 3, 0)">3–∫6</div>
                <div class="quick-dice-btn" onclick="quickRoll('–∫8', 1, 0)">–∫8</div>
                <div class="quick-dice-btn" onclick="quickRoll('–∫10', 1, 0)">–∫10</div>
                <div class="quick-dice-btn" onclick="quickRoll('–∫100', 1, 0)">–∫100</div>
            </div>
            
            <div class="dice-result" id="dice-result">
                –ö–∏–¥–∞–π—Ç–µ –∫—ñ—Å—Ç–∫–∏, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –≤–æ–ª—é –¥–æ–ª—ñ
            </div>
            
            <!-- –Ü—Å—Ç–æ—Ä—ñ—è –∫–∏–¥–∫—ñ–≤ -->
            <div class="dice-history">
                <div style="font-weight: bold; margin-bottom: 10px; text-align: center; color: var(--cossack-blue);">
                    <i class="fas fa-history"></i> –õ—ñ—Ç–æ–ø–∏—Å –ö–∏–¥–∫—ñ–≤
                </div>
                <div id="dice-history-content">
                    <!-- –¢—É—Ç –±—É–¥—É—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–∏–¥–∫–∏ -->
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
        <div class="action-buttons">
            <button class="action-btn save-btn" onclick="saveCharacter()">
                <i class="fas fa-save"></i> –í–Ω–µ—Å—Ç–∏ –¥–æ –†–µ—î—Å—Ç—Ä—É
            </button>
            <button class="action-btn load-btn" onclick="openLoadModal()">
                <i class="fas fa-folder-open"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –†–µ—î—Å—Ç—Ä—É
            </button>
            <button class="action-btn share-btn" onclick="shareCharacter()">
                <i class="fas fa-scroll"></i> –ï–∫—Å–ø–æ—Ä—Ç –¥–ª—è –ö–æ—à–∞
            </button>
            <button class="action-btn generate-btn" onclick="generateRandomCharacter()">
                <i class="fas fa-random"></i> –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¢–æ–≤–∞—Ä–∏—à–∞
            </button>
            <button class="action-btn reset-btn" onclick="resetCharacter()">
                <i class="fas fa-skull-crossbones"></i> –°—Ç–µ—Ä—Ç–∏ –∑ –†–µ—î—Å—Ç—Ä—É
            </button>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É -->
        <div class="modal" id="load-modal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeModal('load-modal')">&times;</span>
                <h3 style="color: var(--cossack-blue); margin-bottom: 15px;">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –ö–æ–∑–∞—Ü—å–∫–æ–≥–æ –†–µ—î—Å—Ç—Ä—É</h3>
                <p>–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—É–≤—ñ–π (JSON —Ñ–∞–π–ª) –∑ –¥–∞–Ω–∏–º–∏ –≤–∞—à–æ–≥–æ –∫–æ–∑–∞–∫–∞:</p>
                <input type="file" id="file-input" accept=".json" style="margin: 15px 0;">
                <button class="action-btn load-btn" style="width: 100%;" onclick="loadFromFile()">
                    <i class="fas fa-upload"></i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –°—É–≤—ñ–π
                </button>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É -->
        <div class="modal" id="share-modal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeModal('share-modal')">&times;</span>
                <h3 style="color: var(--cossack-blue); margin-bottom: 15px;">–ï–∫—Å–ø–æ—Ä—Ç –¥–ª—è –ö–æ–∑–∞—Ü—å–∫–æ–≥–æ –ö–æ—à–∞</h3>
                <p>–ó–±–µ—Ä–µ–∂—ñ—Ç—å —Å—É–≤—ñ–π (JSON —Ñ–∞–π–ª) –∑ –¥–∞–Ω–∏–º–∏ –≤–∞—à–æ–≥–æ –∫–æ–∑–∞–∫–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –æ—Ç–∞–º–∞–Ω—É:</p>
                <div style="background-color: var(--old-paper); padding: 15px; border-radius: 5px; margin: 15px 0; overflow-wrap: break-word; max-height: 200px; overflow-y: auto; border: 1px dashed var(--stain-brown); font-family: monospace;">
                    <code id="json-output"></code>
                </div>
                <button class="action-btn share-btn" style="width: 100%;" onclick="downloadJson()">
                    <i class="fas fa-download"></i> –ó–±–µ—Ä–µ–≥—Ç–∏ –°—É–≤—ñ–π
                </button>
                <p style="margin-top: 15px; font-size: 0.9rem; color: var(--ink-light); text-align: center; font-style: italic;">
                    <i class="fas fa-info-circle"></i> –°—É–≤—ñ–π –º—ñ—Å—Ç–∏—Ç—å —É—Å—ñ –¥–∞–Ω—ñ –∫–æ–∑–∞–∫–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –æ—Ç–∞–º–∞–Ω—É –ö–æ—à–∞
                </p>
            </div>
        </div>
        
        <!-- –¢–æ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è -->
        <div class="toast" id="toast"></div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –∫–æ–∑–∞–∫–∞
        let character = {
            name: "",
            class: "",
            race: "",
            background: "",
            strength: 10,
            dexterity: 10,
            intelligence: 10,
            wisdom: 10,
            charisma: 10,
            constitution: 10,
            hp: 45,
            maxHp: 45,
            level: 1,
            fame: 0, // –°–ª–∞–≤–∞ –∑–∞–º—ñ—Å—Ç—å XP
            inventory: "",
            skills: "",
            buffs: "",
            battleLog: [],
            diceHistory: [],
            nameLocked: false
        };
        
        // –†—ñ–≤–Ω—ñ –¥–æ—Å–≤—ñ–¥—É (–Ω–æ–≤–∞–∫, –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–π, –≤–µ—Ç–µ—Ä–∞–Ω–∏ —Ç.–¥.)
        const experienceLevels = [
            "–ù–æ–≤–∞–∫", "–î–æ—Å–≤—ñ–¥—á–µ–Ω–∏–π", "–ë–æ–π–æ–≤–∏–π –¢–æ–≤–∞—Ä–∏—à", "–í–µ—Ç–µ—Ä–∞–Ω", 
            "–ó–Ω–∞—Ç–Ω–∏–π –í–æ—ó–Ω", "–õ–µ–≥–µ–Ω–¥–∞", "–ë–µ–∑—Å–º–µ—Ä—Ç–Ω–∏–π"
        ];
        
        // –ó–≤–∞–Ω–Ω—è –∫–æ–∑–∞—Ü—å–∫—ñ
        const cossackRanks = ["–ö–æ–∑–∞–∫", "–û—Ç–∞–º–∞–Ω", "–°–æ—Ç–Ω–∏–∫", "–ü–æ–ª–∫–æ–≤–Ω–∏–∫", "–ì–µ—Ç—å–º–∞–Ω", "–ü–∏—Å–∞—Ä", "–û—Å–∞–≤—É–ª", "–•–æ—Ä—É–Ω–∂–∏–π", "–ó–Ω–∞—Ç–Ω–∏–π –í—ñ–π—Å—å–∫–æ–≤–∏–π –¢–æ–≤–∞—Ä–∏—à", "–î–∂—É—Ä–∞", "–ö—É—Ä—ñ–Ω–Ω–∏–π"];
        
        // –ü–æ—Ö–æ–¥–∂–µ–Ω–Ω—è
        const origins = ["–£–∫—Ä–∞—ó–Ω–µ—Ü—å", "–ü–æ–ª—è–∫", "–ú–æ–ª–¥–∞–≤–∞–Ω–∏–Ω", "–¢–∞—Ç–∞—Ä–∏–Ω", "–¢—É—Ä–æ–∫", "–í—ñ—Ä–º–µ–Ω–∏–Ω", "–Ñ–≤—Ä–µ–π", "–ì—Ä–µ–∫", "–°–µ—Ä–±", "–ù—ñ–º–µ—Ü—å"];
        
        // –ñ–∏—Ç—Ç—î–ø–∏—Å–∏
        const backgrounds = [
            "–ù–∞—Ä–æ–¥–∏–≤—Å—è –≤ –∫–æ–∑–∞—Ü—å–∫—ñ–π —Å—ñ–º'—ó, –∑ –¥–∏—Ç–∏–Ω—Å—Ç–≤–∞ –≥–æ—Ç—É–≤–∞–≤—Å—è –¥–æ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó —Å–ª—É–∂–±–∏.",
            "–í—Ç–µ–∫—Ç–∏–π —Å–µ–ª—è–Ω–∏–Ω, —â–æ –∑–Ω–∞–π—à–æ–≤ —Å–≤–æ–±–æ–¥—É —É –í–æ–ª—å–Ω–æ—Å—Ç—è—Ö –í—ñ–π—Å—å–∫–∞ –ó–∞–ø–æ—Ä–æ–∑—å–∫–æ–≥–æ.",
            "–®–ª—è—Ö—Ç–∏—á, —â–æ –ø–æ–∫–∏–Ω—É–≤ —Å–≤—ñ–π —Å—Ç–∞–Ω –∑–∞—Ä–∞–¥–∏ –∫–æ–∑–∞—Ü—å–∫–æ—ó –≤–æ–ª—ñ —Ç–∞ —Å–ª–∞–≤–∏.",
            "–ö–æ–ª–∏—à–Ω—ñ–π —Å–æ–ª–¥–∞—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ—ó –∞—Ä–º—ñ—ó, —â–æ –ø—Ä–∏—Å—Ç–∞–≤ –¥–æ –∫–æ–∑–∞–∫—ñ–≤.",
            "–ú—ñ—â–∞–Ω–∏–Ω, —â–æ —à—É–∫–∞–≤ –ø—Ä–∏–≥–æ–¥ —Ç–∞ –±–∞–≥–∞—Ç—Å—Ç–≤–∞ —É –∫–æ–∑–∞—Ü—å–∫–∏—Ö –ø–æ—Ö–æ–¥–∞—Ö.",
            "–ó–ª–æ—á–∏–Ω–µ—Ü—å, —â–æ –∑–Ω–∞–π—à–æ–≤ –ø—Ä–∏—Ç—É–ª–æ–∫ —É –°—ñ—á—ñ —Ç–∞ –≤–∏–∫—É–ø–∏–≤ —Å–≤–æ—é –ø—Ä–æ–≤–∏–Ω—É –∫—Ä–æ–≤'—é –≤–æ—Ä–æ–≥—ñ–≤.",
            "–°–∏–Ω —Å–≤—è—â–µ–Ω–∏–∫–∞, —â–æ –æ–±—Ä–∞–≤ —à–ª—è—Ö –≤–æ—ó–Ω–∞ –∑–∞–º—ñ—Å—Ç—å –¥—É—Ö–æ–≤–Ω–æ–≥–æ —Å–∞–Ω—É.",
            "–Ü–Ω–æ–∑–µ–º–Ω–∏–π –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç, —â–æ –ø—Ä–∏—Å—Ç–∞–≤ –¥–æ –∫–æ–∑–∞–∫—ñ–≤ –∑–∞—Ä–∞–¥–∏ —Å–ª–∞–≤–∏ —Ç–∞ –±–∞–≥–∞—Ç—Å—Ç–≤–∞.",
            "–ü–æ—Ç–æ–º–æ–∫ —Å—Ç–∞—Ä–æ–¥–∞–≤–Ω—å–æ–≥–æ –∫–æ–∑–∞—Ü—å–∫–æ–≥–æ —Ä–æ–¥—É, —â–æ –ø—Ä–æ–¥–æ–≤–∂—É—î —Ç—Ä–∞–¥–∏—Ü—ñ—ó –ø—Ä–µ–¥–∫—ñ–≤.",
            "–†–µ–º—ñ—Å–Ω–∏–∫, —â–æ –ø–æ–∫–∏–Ω—É–≤ —Ä–µ–º–µ—Å–ª–æ –∑–∞—Ä–∞–¥–∏ –≤–æ–ª—ñ —Ç–∞ –ª–∏—Ü–∞—Ä—Å—å–∫–æ—ó —Å–ª–∞–≤–∏."
        ];
        
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            // –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ–≥–æ –∫–æ–∑–∞–∫–∞ –∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ö–æ–≤–∏—â–∞
            const savedCharacter = localStorage.getItem('cossack-character');
            if (savedCharacter) {
                const parsed = JSON.parse(savedCharacter);
                character = {...character, ...parsed};
                updateFormFromCharacter();
                
                // –Ø–∫—â–æ —ñ–º'—è –≤–∂–µ –±—É–ª–æ –≤–Ω–µ—Å–µ–Ω–æ –¥–æ —Ä–µ—î—Å—Ç—Ä—É, –±–ª–æ–∫—É—î–º–æ –π–æ–≥–æ
                if (character.name && character.nameLocked) {
                    lockNameField();
                }
            }
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø–æ–¥—ñ–π –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∑–∞–∫–∞ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ñ–æ—Ä–º–∏
            document.getElementById('character-name').addEventListener('input', function() {
                if (!character.nameLocked) {
                    character.name = this.value;
                    saveToLocalStorage();
                }
            });
            
            document.getElementById('character-class').addEventListener('change', function() {
                character.class = this.value;
                updateHPBasedOnRank();
                saveToLocalStorage();
            });
            
            document.getElementById('character-race').addEventListener('change', function() {
                character.race = this.value;
                saveToLocalStorage();
            });
            
            document.getElementById('character-background').addEventListener('input', function() {
                character.background = this.value;
                saveToLocalStorage();
            });
            
            document.getElementById('inventory').addEventListener('input', function() {
                character.inventory = this.value;
                saveToLocalStorage();
            });
            
            document.getElementById('skills').addEventListener('input', function() {
                character.skills = this.value;
                saveToLocalStorage();
            });
            
            document.getElementById('buffs').addEventListener('input', function() {
                character.buffs = this.value;
                saveToLocalStorage();
            });
            
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª–æ–≥—É –±–∏—Ç–≤
            if (character.battleLog.length === 0) {
                character.battleLog.push({
                    action: "–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω",
                    amount: character.maxHp,
                    timestamp: new Date().toLocaleTimeString(),
                    currentHp: character.maxHp
                });
                updateBattleLog();
            }
            
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ—Å—Ç–æ—Ä—ñ—ó –∫–∏–¥–∫—ñ–≤
            if (character.diceHistory.length === 0) {
                updateDiceHistory();
            }
        });
        
        // –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø–æ–ª—è —ñ–º–µ–Ω—ñ –ø—ñ—Å–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –¥–æ —Ä–µ—î—Å—Ç—Ä—É
        function lockNameField() {
            const nameInput = document.getElementById('character-name');
            nameInput.readOnly = true;
            nameInput.classList.add('locked');
            character.nameLocked = true;
            
            document.getElementById('name-lock').style.display = 'block';
            document.getElementById('character-final-seal').style.display = 'flex';
            
            showToast("–Ü–º'—è –∫–æ–∑–∞–∫–∞ –≤–Ω–µ—Å–µ–Ω–æ –¥–æ —Ä–µ—î—Å—Ç—Ä—É —Ç–∞ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ –¥–ª—è –∑–º—ñ–Ω");
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –æ–±'—î–∫—Ç–∞ –∫–æ–∑–∞–∫–∞
        function updateFormFromCharacter() {
            document.getElementById('character-name').value = character.name;
            document.getElementById('character-class').value = character.class;
            document.getElementById('character-race').value = character.race;
            document.getElementById('character-background').value = character.background;
            document.getElementById('strength-value').textContent = character.strength;
            document.getElementById('dexterity-value').textContent = character.dexterity;
            document.getElementById('intelligence-value').textContent = character.intelligence;
            document.getElementById('wisdom-value').textContent = character.wisdom;
            document.getElementById('charisma-value').textContent = character.charisma;
            document.getElementById('constitution-value').textContent = character.constitution;
            document.getElementById('inventory').value = character.inventory;
            document.getElementById('skills').value = character.skills;
            document.getElementById('buffs').value = character.buffs;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            updateModifiers();
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è HP —Ç–∞ —Ä—ñ–≤–Ω—è
            document.getElementById('hp-value').textContent = character.hp;
            document.getElementById('max-hp-value').textContent = character.maxHp;
            document.getElementById('level-badge').textContent = `–î–æ—Å–≤—ñ–¥: ${experienceLevels[character.level - 1] || experienceLevels[0]}`;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ª–∞–≤–∏
            updateFameDisplay();
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–≥—ñ–≤
            updateBattleLog();
            updateDiceHistory();
            
            // –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ, —è–∫—â–æ –≤–æ–Ω–æ –≤–∂–µ –±—É–ª–æ –≤–Ω–µ—Å–µ–Ω–æ –¥–æ —Ä–µ—î—Å—Ç—Ä—É
            if (character.name && character.nameLocked) {
                lockNameField();
            }
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
        function updateModifiers() {
            // –§–æ—Ä–º—É–ª–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞: (–∑–Ω–∞—á–µ–Ω–Ω—è - 10) / 2, –æ–∫—Ä—É–≥–ª–µ–Ω–µ –≤–Ω–∏–∑
            const stats = ['strength', 'dexterity', 'intelligence', 'wisdom', 'charisma', 'constitution'];
            
            stats.forEach(stat => {
                const value = character[stat];
                const mod = Math.floor((value - 10) / 2);
                document.getElementById(`${stat}-mod`).textContent = formatModifier(mod);
            });
        }
        
        // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –∑—ñ –∑–Ω–∞–∫–æ–º
        function formatModifier(mod) {
            return mod >= 0 ? `+${mod}` : `${mod}`;
        }
        
        // –ö–∏–¥–∞–Ω–Ω—è –∫—ñ—Å—Ç–∫–∏ –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        function rollStat(stat) {
            const diceCount = 3;
            const diceType = 6;
            let total = 0;
            let rolls = [];
            
            // –ö–∏–¥–∞–Ω–Ω—è –∫—ñ—Å—Ç–æ–∫
            for (let i = 0; i < diceCount; i++) {
                const roll = Math.floor(Math.random() * diceType) + 1;
                rolls.push(roll);
                total += roll;
            }
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
            character[stat] = total;
            document.getElementById(`${stat}-value`).textContent = total;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤
            updateModifiers();
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è HP, —è–∫—â–æ –∑–º—ñ–Ω–∏–ª–∞—Å—è –≤–∏—Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å
            if (stat === 'constitution') {
                updateHPBasedOnConstitution();
            }
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —ñ—Å—Ç–æ—Ä—ñ—ó –∫–∏–¥–∫—ñ–≤
            addToDiceHistory(`3–∫6 –¥–ª—è ${getStatName(stat)}: ${rolls.join(' + ')} = ${total}`);
            
            // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
            showToast(`–ö–∏–Ω—É—Ç–æ ${diceCount}–∫${diceType} –¥–ª—è ${getStatName(stat)}: ${rolls.join(' + ')} = ${total}`);
            
            // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω
            saveToLocalStorage();
        }
        
        // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞–∑–≤–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é
        function getStatName(stat) {
            const statNames = {
                'strength': '–ú—ñ—Ü—å',
                'dexterity': '–°–ø—Ä–∏—Ç–Ω—ñ—Å—Ç—å',
                'intelligence': '–†–æ–∑—É–º',
                'wisdom': '–ú—É–¥—Ä—ñ—Å—Ç—å',
                'charisma': '–•–æ—Ä–æ–±—Ä—ñ—Å—Ç—å',
                'constitution': '–í–∏—Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å'
            };
            return statNames[stat] || stat;
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è HP –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–≤–∞–Ω–Ω—è
        function updateHPBasedOnRank() {
            // –ë–∞–∑–æ–≤–µ HP –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∑–≤–∞–Ω–Ω—è
            const rankHpMap = {
                '–ì–µ—Ç—å–º–∞–Ω': { min: 60, max: 80 },
                '–ü–æ–ª–∫–æ–≤–Ω–∏–∫': { min: 50, max: 70 },
                '–°–æ—Ç–Ω–∏–∫': { min: 45, max: 65 },
                '–û—Ç–∞–º–∞–Ω': { min: 40, max: 60 },
                '–û—Å–∞–≤—É–ª': { min: 40, max: 55 },
                '–•–æ—Ä—É–Ω–∂–∏–π': { min: 35, max: 50 },
                '–ó–Ω–∞—Ç–Ω–∏–π –í—ñ–π—Å—å–∫–æ–≤–∏–π –¢–æ–≤–∞—Ä–∏—à': { min: 35, max: 50 },
                '–ö—É—Ä—ñ–Ω–Ω–∏–π': { min: 35, max: 50 },
                '–ö–æ–∑–∞–∫': { min: 30, max: 45 },
                '–ü–∏—Å–∞—Ä': { min: 25, max: 40 },
                '–î–∂—É—Ä–∞': { min: 20, max: 35 }
            };
            
            const rankHp = rankHpMap[character.class] || { min: 30, max: 45 };
            
            if (character.level === 1) {
                // –†–∞–Ω–¥–æ–º–Ω–µ HP –≤ –º–µ–∂–∞—Ö –¥–ª—è –∑–≤–∞–Ω–Ω—è
                const range = rankHp.max - rankHp.min;
                character.maxHp = Math.floor(Math.random() * (range + 1)) + rankHp.min;
                character.hp = character.maxHp;
                
                document.getElementById('hp-value').textContent = character.hp;
                document.getElementById('max-hp-value').textContent = character.maxHp;
                
                // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–≥—É
                character.battleLog = [{
                    action: "–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω",
                    amount: character.maxHp,
                    timestamp: new Date().toLocaleTimeString(),
                    currentHp: character.maxHp
                }];
                updateBattleLog();
            }
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è HP –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏—Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ
        function updateHPBasedOnConstitution() {
            if (character.level === 1) return;
            
            // –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ HP –¥–ª—è –≤–∏—â–∏—Ö —Ä—ñ–≤–Ω—ñ–≤ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –Ω–æ–≤–æ—ó –≤–∏—Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ
            const oldConMod = Math.floor((10 - 10) / 2);
            const newConMod = Math.floor((character.constitution - 10) / 2);
            const conDiff = newConMod - oldConMod;
            
            // –î–æ–¥–∞—î–º–æ —Ä—ñ–∑–Ω–∏—Ü—é –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ –¥—Ä—É–≥–æ–≥–æ
            character.maxHp += conDiff * (character.level - 1);
            character.hp = Math.min(character.hp, character.maxHp);
            
            document.getElementById('hp-value').textContent = character.hp;
            document.getElementById('max-hp-value').textContent = character.maxHp;
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –≤ –ª–æ–≥
            addToBattleLog(`–ó–º—ñ–Ω–∞ –≤–∏—Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ`, conDiff * (character.level - 1));
        }
        
        // –ó–º—ñ–Ω–∞ HP (–ø–æ—Ä–∞–Ω–µ–Ω–Ω—è/–ª—ñ–∫—É–≤–∞–Ω–Ω—è)
        function changeHP(amount) {
            const oldHp = character.hp;
            character.hp += amount;
            
            // –û–±–º–µ–∂–µ–Ω–Ω—è HP –≤ –º–µ–∂–∞—Ö 0 - maxHp
            character.hp = Math.max(0, Math.min(character.hp, character.maxHp));
            
            document.getElementById('hp-value').textContent = character.hp;
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –≤ –ª–æ–≥
            const action = amount < 0 ? "–ü–æ—Ä–∞–Ω–µ–Ω–Ω—è" : "–õ—ñ–∫—É–≤–∞–Ω–Ω—è";
            addToBattleLog(`${action}`, amount, oldHp);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —Å–º–µ—Ä—Ç—å
            if (character.hp <= 0) {
                showToast("‚ö∞Ô∏è –ö–æ–∑–∞–∫ –ø–∞–≤ —É –±–æ—é! –ü–æ—Ç—Ä–µ–±—É—î –Ω–µ–≥–∞–π–Ω–æ—ó –¥–æ–ø–æ–º–æ–≥–∏!", true);
            }
            
            saveToLocalStorage();
        }
        
        // –ü–æ–≤–Ω–µ –ª—ñ–∫—É–≤–∞–Ω–Ω—è
        function healFull() {
            const oldHp = character.hp;
            const amount = character.maxHp - character.hp;
            
            if (amount > 0) {
                character.hp = character.maxHp;
                document.getElementById('hp-value').textContent = character.hp;
                
                addToBattleLog("–ü–æ–≤–Ω–µ –æ–¥—É–∂–∞–Ω–Ω—è", amount, oldHp);
                showToast("–ö–æ–∑–∞–∫ –ø–æ–≤–Ω—ñ—Å—Ç—é –æ–¥—É–∂–∞–≤ —Ç–∞ –≥–æ—Ç–æ–≤–∏–π –¥–æ –±–æ—é!");
                
                saveToLocalStorage();
            }
        }
        
        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –≤ –ª–æ–≥ –±–∏—Ç–≤
        function addToBattleLog(action, amount, oldHp = character.hp) {
            character.battleLog.push({
                action: action,
                amount: amount,
                timestamp: new Date().toLocaleTimeString(),
                currentHp: character.hp
            });
            
            // –û–±–º–µ–∂—É—î–º–æ –ª–æ–≥ –æ—Å—Ç–∞–Ω–Ω—ñ–º–∏ 10 –∑–∞–ø–∏—Å–∞–º–∏
            if (character.battleLog.length > 10) {
                character.battleLog = character.battleLog.slice(-10);
            }
            
            updateBattleLog();
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ª–æ–≥—É –±–∏—Ç–≤
        function updateBattleLog() {
            const logContent = document.getElementById('battle-log-content');
            logContent.innerHTML = '';
            
            character.battleLog.forEach(entry => {
                const item = document.createElement('div');
                item.className = 'battle-log-item';
                
                const amountClass = entry.amount > 0 ? 'battle-heal' : 'battle-damage';
                const amountText = entry.amount > 0 ? `+${entry.amount}` : entry.amount;
                
                item.innerHTML = `
                    <div>
                        <div>${entry.action}</div>
                        <div style="font-size: 0.8rem; color: var(--ink-light);">${entry.timestamp}</div>
                    </div>
                    <div class="${amountClass}">${amountText} –ñ–°</div>
                `;
                
                logContent.appendChild(item);
            });
            
            // –ü—Ä–æ–∫—Ä—É—á—É—î–º–æ –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∑–∞–ø–∏—Å—É
            logContent.scrollTop = logContent.scrollHeight;
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å–ª–∞–≤–∏
        function updateFameDisplay() {
            const requiredFame = getRequiredFame(character.level);
            const percentage = Math.min(100, Math.floor((character.fame / requiredFame) * 100));
            
            document.getElementById('current-fame').textContent = character.fame;
            document.getElementById('required-fame').textContent = requiredFame;
            document.getElementById('fame-percentage').textContent = `${percentage}%`;
            document.getElementById('fame-progress').textContent = `${percentage}%`;
            document.getElementById('fame-progress').style.width = `${percentage}%`;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–∑–Ω–∞—á–∫–∏ –¥–æ—Å–≤—ñ–¥—É
            document.getElementById('level-badge').textContent = `–î–æ—Å–≤—ñ–¥: ${experienceLevels[character.level - 1] || experienceLevels[0]}`;
        }
        
        // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—ó —Å–ª–∞–≤–∏ –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è
        function getRequiredFame(level) {
            // –î–ª—è 2 —Ä—ñ–≤–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ 50 —Å–ª–∞–≤–∏, –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ +100
            return 50 + (level - 1) * 100;
        }
        
        // –î–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ª–∞–≤–∏
        function addFame(amount) {
            if (amount <= 0) return;
            
            character.fame += amount;
            const requiredFame = getRequiredFame(character.level);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è
            let levelsGained = 0;
            while (character.fame >= requiredFame) {
                character.level++;
                character.fame -= requiredFame;
                levelsGained++;
                
                // –û–Ω–æ–≤–ª–µ–Ω–Ω—è HP –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è
                levelUpHPGain();
            }
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
            updateFameDisplay();
            
            // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä—ñ–≤–Ω—è
            if (levelsGained > 0) {
                const newLevelName = experienceLevels[character.level - 1] || experienceLevels[0];
                showToast(`–°–ª–∞–≤–∞ –∫–æ–∑–∞—Ü—å–∫–∞! –í–∞—à —Ç–æ–≤–∞—Ä–∏—à –æ—Ç—Ä–∏–º–∞–≤ ${levelsGained} —Ä—ñ–≤–µ–Ω—å(—ñ–≤)! –¢–µ–ø–µ—Ä –≤—ñ–Ω ${newLevelName}.`);
            } else {
                showToast(`–î–æ–¥–∞–Ω–æ ${amount} —Å–ª–∞–≤–∏. –ó–∞–ª–∏—à–∏–ª–æ—Å—å ${requiredFame - character.fame} –¥–æ –Ω–æ–≤–æ–≥–æ —Ä—ñ–≤–Ω—è.`);
            }
            
            // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω
            saveToLocalStorage();
        }
        
        // –ó–±—ñ–ª—å—à–µ–Ω–Ω—è HP –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Ä—ñ–≤–Ω—è
        function levelUpHPGain() {
            // HP –ø—Ä–∏—Ä—ñ—Å—Ç –∑–∞ —Ä—ñ–≤–µ–Ω—å –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –∑–≤–∞–Ω–Ω—è
            const rankHpGain = {
                '–ì–µ—Ç—å–º–∞–Ω': { min: 10, max: 15 },
                '–ü–æ–ª–∫–æ–≤–Ω–∏–∫': { min: 8, max: 12 },
                '–°–æ—Ç–Ω–∏–∫': { min: 7, max: 11 },
                '–û—Ç–∞–º–∞–Ω': { min: 6, max: 10 },
                '–û—Å–∞–≤—É–ª': { min: 6, max: 10 },
                '–•–æ—Ä—É–Ω–∂–∏–π': { min: 5, max: 9 },
                '–ó–Ω–∞—Ç–Ω–∏–π –í—ñ–π—Å—å–∫–æ–≤–∏–π –¢–æ–≤–∞—Ä–∏—à': { min: 5, max: 9 },
                '–ö—É—Ä—ñ–Ω–Ω–∏–π': { min: 5, max: 9 },
                '–ö–æ–∑–∞–∫': { min: 4, max: 8 },
                '–ü–∏—Å–∞—Ä': { min: 3, max: 6 },
                '–î–∂—É—Ä–∞': { min: 3, max: 6 }
            };
            
            const hpGainRange = rankHpGain[character.class] || { min: 4, max: 8 };
            const range = hpGainRange.max - hpGainRange.min;
            const hpGain = Math.floor(Math.random() * (range + 1)) + hpGainRange.min;
            
            // –î–æ–¥–∞—î–º–æ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –≤–∏—Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ
            const conMod = Math.floor((character.constitution - 10) / 2);
            const totalGain = Math.max(1, hpGain + conMod);
            
            character.maxHp += totalGain;
            character.hp += totalGain;
            
            document.getElementById('hp-value').textContent = character.hp;
            document.getElementById('max-hp-value').textContent = character.maxHp;
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –≤ –ª–æ–≥
            addToBattleLog(`–ù–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –¥–æ—Å–≤—ñ–¥—É`, totalGain);
        }
        
        // –ö–∏–¥–∞–Ω–Ω—è –∫—ñ—Å—Ç–æ–∫
        function rollDice() {
            const diceType = parseInt(document.getElementById('dice-type').value);
            const diceCount = parseInt(document.getElementById('dice-count').value);
            const modifier = parseInt(document.getElementById('modifier').value);
            
            performDiceRoll(diceType, diceCount, modifier);
        }
        
        // –®–≤–∏–¥–∫–µ –∫–∏–¥–∞–Ω–Ω—è –∫—ñ—Å—Ç–æ–∫
        function quickRoll(diceType, diceCount, modifier) {
            // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ '–∫20' –≤ 20 —Ç–æ—â–æ
            const type = parseInt(diceType.replace('–∫', ''));
            performDiceRoll(type, diceCount, modifier);
        }
        
        // –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–∏–¥–∫–∞ –∫—ñ—Å—Ç–æ–∫
        function performDiceRoll(diceType, diceCount, modifier) {
            // –ê–Ω—ñ–º–∞—Ü—ñ—è –∫–∏–¥–∞–Ω–Ω—è
            const diceResult = document.getElementById('dice-result');
            diceResult.innerHTML = '<div class="dice-animation"><i class="fas fa-dice-d20"></i></div>';
            
            // –û—á–∏—â–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(() => {
                let total = 0;
                let rolls = [];
                let naturalTotal = 0;
                
                // –ö–∏–¥–∞–Ω–Ω—è –∫—ñ—Å—Ç–æ–∫
                for (let i = 0; i < diceCount; i++) {
                    const roll = Math.floor(Math.random() * diceType) + 1;
                    rolls.push(roll);
                    naturalTotal += roll;
                }
                
                // –î–æ–¥–∞–≤–∞–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞
                total = naturalTotal + modifier;
                
                // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                let resultText = `–ö–∏–Ω—É—Ç–æ ${diceCount}–∫${diceType}`;
                if (modifier !== 0) {
                    resultText += ` ${modifier >= 0 ? '+' : ''}${modifier}`;
                }
                resultText += `: ${rolls.join(' + ')}`;
                
                if (modifier !== 0) {
                    resultText += ` ${modifier >= 0 ? '+' : ''}${modifier} = ${total}`;
                } else {
                    resultText += ` = ${total}`;
                }
                
                // –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –∫20
                if (diceType === 20 && diceCount === 1) {
                    if (rolls[0] === 20) {
                        resultText += " ‚ö° –ö–†–ò–¢–ò–ß–ù–ò–ô –£–°–ü–Ü–•! –í–æ–ª—è –ë–æ–∂–∞!";
                    } else if (rolls[0] === 1) {
                        resultText += " üíÄ –ö–†–ò–¢–ò–ß–ù–ò–ô –ü–†–û–í–ê–õ! –õ–∏—Ö–∞ –¥–æ–ª—è...";
                    }
                }
                
                diceResult.innerHTML = resultText;
                
                // –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —ñ—Å—Ç–æ—Ä—ñ—ó –∫–∏–¥–∫—ñ–≤
                addToDiceHistory(resultText);
                
                showToast(resultText);
            }, 1000);
        }
        
        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ —ñ—Å—Ç–æ—Ä—ñ—ó –∫–∏–¥–∫—ñ–≤
        function addToDiceHistory(rollText) {
            character.diceHistory.push({
                text: rollText,
                timestamp: new Date().toLocaleTimeString()
            });
            
            // –û–±–º–µ–∂—É—î–º–æ —ñ—Å—Ç–æ—Ä—ñ—é –æ—Å—Ç–∞–Ω–Ω—ñ–º–∏ 10 –∫–∏–¥–∫–∞–º–∏
            if (character.diceHistory.length > 10) {
                character.diceHistory = character.diceHistory.slice(-10);
            }
            
            updateDiceHistory();
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó –∫–∏–¥–∫—ñ–≤
        function updateDiceHistory() {
            const historyContent = document.getElementById('dice-history-content');
            historyContent.innerHTML = '';
            
            character.diceHistory.forEach(entry => {
                const item = document.createElement('div');
                item.className = 'dice-history-item';
                item.innerHTML = `
                    <div>${entry.text}</div>
                    <div style="font-size: 0.8rem; color: var(--ink-light);">${entry.timestamp}</div>
                `;
                historyContent.appendChild(item);
            });
            
            // –ü—Ä–æ–∫—Ä—É—á—É—î–º–æ –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∑–∞–ø–∏—Å—É
            historyContent.scrollTop = historyContent.scrollHeight;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –∫–æ–∑–∞–∫–∞
        function generateRandomCharacter() {
            // –í–∏–ø–∞–¥–∫–æ–≤–µ —ñ–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ
            const firstNames = ["–Ü–≤–∞–Ω", "–ü–µ—Ç—Ä–æ", "–û–ª–µ–∫—Å—ñ–π", "–ì—Ä–∏–≥–æ—Ä—ñ–π", "–¢–∞—Ä–∞—Å", "–°–µ–º–µ–Ω", "–Ø–∫—ñ–≤", "–í–∞—Å–∏–ª—å", "–ú–∏—Ö–∞–π–ª–æ", "–î–º–∏—Ç—Ä–æ", "–ê–Ω–¥—Ä—ñ–π", "–Æ—Ä—ñ–π", "–ü–∞–≤–ª–æ", "–ú–∞–∫–∞—Ä", "–§–µ–¥—ñ—Ä"];
            const lastNames = ["–®–µ–≤—á–µ–Ω–∫–æ", "–§—Ä–∞–Ω–∫–æ", "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π", "–°–∞–≥–∞–π–¥–∞—á–Ω–∏–π", "–î–æ—Ä–æ—à–µ–Ω–∫–æ", "–ú–∞–∑–µ–ø–∞", "–í–∏—à–Ω–µ–≤–µ—Ü—å–∫–∏–π", "–ë–∞–π–¥–∞", "–ù–∞–ª–∏–≤–∞–π–∫–æ", "–°—ñ—Ä–∫–æ", "–ì–æ–Ω—á–∞—Ä–µ–Ω–∫–æ", "–ö–æ–≤–∞–ª–µ–Ω–∫–æ", "–ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ", "–¢–∫–∞—á–µ–Ω–∫–æ", "–ú–µ–ª—å–Ω–∏—á–µ–Ω–∫–æ"];
            
            character.name = `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`;
            
            // –í–∏–ø–∞–¥–∫–æ–≤–µ –∑–≤–∞–Ω–Ω—è
            character.class = cossackRanks[Math.floor(Math.random() * cossackRanks.length)];
            
            // –í–∏–ø–∞–¥–∫–æ–≤–µ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è
            character.race = origins[Math.floor(Math.random() * origins.length)];
            
            // –í–∏–ø–∞–¥–∫–æ–≤–∏–π –∂–∏—Ç—Ç—î–ø–∏—Å
            character.background = backgrounds[Math.floor(Math.random() * backgrounds.length)];
            
            // –í–∏–ø–∞–¥–∫–æ–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (–∫–∏–¥–∞–Ω–Ω—è 4–∫6, –≤—ñ–¥–∫–∏–¥–∞—î–º–æ –Ω–∞–π–Ω–∏–∂—á–∏–π)
            character.strength = roll4k6DropLowest();
            character.dexterity = roll4k6DropLowest();
            character.intelligence = roll4k6DropLowest();
            character.wisdom = roll4k6DropLowest();
            character.charisma = roll4k6DropLowest();
            character.constitution = roll4k6DropLowest();
            
            // –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å —Ç–∞ HP
            character.level = 1;
            character.fame = 0;
            updateHPBasedOnRank();
            
            // –í–∏–ø–∞–¥–∫–æ–≤–µ —Å–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è
            const inventoryItems = [
                "–°–∞–±–ª—è, –ø—ñ—Å—Ç–æ–ª—å, –∫–∏–Ω–¥–∂–∞–ª, –∫–æ–ª—å—á—É–≥–∞, —à–æ–ª–æ–º, 50 –∑–æ–ª–æ—Ç–∏—Ö —á–µ—Ä–≤—ñ–Ω—Ü—ñ–≤",
                "–°–ø–∏—Å, –ª—É–∫–∞ –∑ —Å—Ç—Ä—ñ–ª–∞–º–∏, —à–∞–±–ª—è, —à–∫—ñ—Ä—è–Ω–∞ –∫—É—Ä—Ç–∫–∞, —Ç—Ä–æ—Ñ–µ–π–Ω–∏–π —Ç—É—Ä–µ—Ü—å–∫–∏–π –∫–∏–Ω–∂–∞–ª, 30 —á–µ—Ä–≤—ñ–Ω—Ü—ñ–≤",
                "–ë–µ—Ä–¥–∏—à, –ø—ñ—Å—Ç–æ–ª—ñ (–ø–∞—Ä–∞), –∫–æ–ª—å—á—É–≥–∞, —Ä—ñ–≥ –∑ –ø–æ—Ä–æ—Ö–æ–º, –∫—Ä–µ–º–µ–Ω—å, 100 –∑–æ–ª–æ—Ç–∏—Ö",
                "–®–∞–±–ª—è, –±—É–ª–∞–≤–∞, —â–∏—Ç, –∫–æ–ª—å—á—É–≥–∞, —Ç—Ä–æ—Ñ–µ–π–Ω–∏–π —Ç—É—Ä–µ—Ü—å–∫–∏–π —à–æ–ª–æ–º, 75 —á–µ—Ä–≤—ñ–Ω—Ü—ñ–≤",
                "–°–æ–∫–∏—Ä–∞-–±–∞—Ä—Ç–∫–∞, –ø—ñ—Å—Ç–æ–ª—å, –∫–∏–Ω–¥–∂–∞–ª, —à–∫—ñ—Ä—è–Ω–∞ –∫—É—Ä—Ç–∫–∞, –Ω–∞–±—ñ—Ä –¥–ª—è –ª—ñ–∫—É–≤–∞–Ω–Ω—è, 40 –∑–æ–ª–æ—Ç–∏—Ö",
                "–°–∞–±–ª—è, –ª—É–∫, 20 —Å—Ç—Ä—ñ–ª, –ª–µ–≥–∫–∞ –∫–æ–ª—å—á—É–≥–∞, —Ç–æ—Ä–±–∞ –∑ –ø—Ä–æ–≤—ñ–∑—ñ—î—é, 60 —á–µ—Ä–≤—ñ–Ω—Ü—ñ–≤"
            ];
            character.inventory = inventoryItems[Math.floor(Math.random() * inventoryItems.length)];
            
            // –í–∏–ø–∞–¥–∫–æ–≤—ñ –≤–º—ñ–Ω–Ω—è
            const skills = [
                "–í–µ—Ä—Ö–æ–≤–∞ —ó–∑–¥–∞, –§–µ—Ö—Ç—É–≤–∞–Ω–Ω—è, –°—Ç—Ä—ñ–ª—å–±–∞ –∑ –ª—É–∫–∞, –í–∏–∂–∏–≤–∞–Ω–Ω—è –≤ —Å—Ç–µ–ø—É",
                "–ö–µ—Ä—É–≤–∞–Ω–Ω—è —á–æ–≤–Ω–æ–º, –ü–ª–∞–≤–∞–Ω–Ω—è, –ú–µ—Ç–µ–ª–µ–Ω–Ω—è –≤–æ—Ä–æ–∂–æ—ó —Ä–æ–∑–≤—ñ–¥–∫–∏, –¢–∞–∫—Ç–∏–∫–∞ –º–∞–ª–∏—Ö –∑–∞–≥–æ–Ω—ñ–≤",
                "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∏, –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —à–ª—è—Ö—É, –õ—ñ–∫—É–≤–∞–Ω–Ω—è —Ä–∞–Ω, –ó–Ω–∞–Ω–Ω—è —Ç—É—Ä–µ—Ü—å–∫–æ—ó –º–æ–≤–∏",
                "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≥–∞—Ä–º–∞—Ç–æ—é, –û–±–ª–æ–≥–æ–≤—ñ —Å–ø—Ä–∞–≤–∏, –ë—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ —É–∫—Ä—ñ–ø–ª–µ–Ω—å, –ö–∞—Ä—Ç–æ–≥—Ä–∞—Ñ—ñ—è",
                "–ü–æ–ª—é–≤–∞–Ω–Ω—è, –¢–æ—Ä–≥—ñ–≤–ª—è, –†–µ–º–æ–Ω—Ç –∑–±—Ä–æ—ó, –ó–Ω–∞–Ω–Ω—è —Ç–∞—Ç–∞—Ä—Å—å–∫–æ—ó –º–æ–≤–∏",
                "–†–æ–∑–≤—ñ–¥–∫–∞, –ú–∞—Å–∫—É–≤–∞–Ω–Ω—è, –ù—ñ—á–Ω—ñ –≤–∏–ª–∞–∑–∫–∏, –ó–Ω–∞–Ω–Ω—è –ø–æ–ª—å—Å—å–∫–æ—ó –º–æ–≤–∏"
            ];
            character.skills = skills[Math.floor(Math.random() * skills.length)];
            
            // –í–∏–ø–∞–¥–∫–æ–≤—ñ —è–∫–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–∏–≤—ñ–ª–µ—ó
            const buffs = [
                "–ó–Ω–∞–π–æ–º—Å—Ç–≤–æ –∑ –≥–µ—Ç—å–º–∞–Ω–æ–º: –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ–ø–æ–º–æ–≥—É –≤—ñ–¥ –≤–∏—â–æ–≥–æ –∫–æ–º–∞–Ω–¥—É–≤–∞–Ω–Ω—è\n–í—ñ–¥–∑–Ω–∞–∫–∞ –∑–∞ —Ö–æ—Ä–æ–±—Ä—ñ—Å—Ç—å: +2 –¥–æ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç—É —Å–µ—Ä–µ–¥ –∫–æ–∑–∞–∫—ñ–≤\n–ó–Ω–∞–Ω–Ω—è —Ç—É—Ä–µ—Ü—å–∫–∏—Ö –∑–≤–∏—á–∞—ó–≤: –õ–µ–≥—à–µ –≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∏ –∑ –æ—Å–º–∞–Ω–∞–º–∏",
                "–ë–∞–≥–∞—Ç–∏–π —Ç—Ä–æ—Ñ–µ–π: –ú–∞—î –∫–æ—à—Ç–æ–≤–Ω—É —Ç—É—Ä–µ—Ü—å–∫—É –∑–±—Ä–æ—é, —è–∫—É –º–æ–∂–µ –ø—Ä–æ–¥–∞—Ç–∏\n–î–æ—Å–≤—ñ–¥ –º–æ—Ä—Å—å–∫–∏—Ö –ø–æ—Ö–æ–¥—ñ–≤: +3 –¥–æ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –Ω–∞ –º–æ—Ä—ñ\n–ó–≤'—è–∑–∫–∏ –≤ –û—Å–º–∞–Ω—Å—å–∫—ñ–π —ñ–º–ø–µ—Ä—ñ—ó: –ú–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –°—Ç–∞–º–±—É–ª–∞",
                "–ú–∞–π—Å—Ç–µ—Ä —Ñ–µ—Ö—Ç—É–≤–∞–Ω–Ω—è: +2 –¥–æ –∞—Ç–∞–∫ —à–∞–±–ª–µ—é\n–ù–µ–∑–ª–∞–º–Ω–∏–π –¥—É—Ö: –û–ø—ñ—Ä —Å—Ç—Ä–∞—Ö—É —Ç–∞ –∑–∞–ª—è–∫—É–≤–∞–Ω–Ω—é\n–ó–Ω–∞–Ω–Ω—è –ª—ñ–∫–∞—Ä—Å—å–∫–∏—Ö —Ç—Ä–∞–≤: –ú–æ–∂–µ –ª—ñ–∫—É–≤–∞—Ç–∏ –ø–æ—Ä–∞–Ω–µ–Ω–Ω—è –≤ –ø–æ–ª—å–æ–≤–∏—Ö —É–º–æ–≤–∞—Ö",
                "–ú–æ–≤–∏: –í–æ–ª–æ–¥—ñ—î –ø–æ–ª—å—Å—å–∫–æ—é, —Ç–∞—Ç–∞—Ä—Å—å–∫–æ—é —Ç–∞ —Ç—É—Ä–µ—Ü—å–∫–æ—é\n–î–∏–ø–ª–æ–º–∞—Ç: –ú–æ–∂–µ –≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∏ –∑ —ñ–Ω–æ–∑–µ–º—Ü—è–º–∏\n–ó–Ω–∞–π–æ–º—Å—Ç–≤–æ –∑ –∫–æ—Ä–¥–æ–Ω–æ–º: –ù–µ–ø–æ–≥–∞–Ω–æ –æ—Ä—ñ—î–Ω—Ç—É—î—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–∫–æ—Ä–¥–æ–Ω–Ω–∏—Ö –∑–µ–º–ª—è—Ö"
            ];
            character.buffs = buffs[Math.floor(Math.random() * buffs.length)];
            
            // –Ü–º'—è –Ω–µ –±–ª–æ–∫—É—î–º–æ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó
            character.nameLocked = false;
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏
            updateFormFromCharacter();
            
            // –ü–æ–∫–∞–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            showToast(`–°—Ç–≤–æ—Ä–µ–Ω–æ –∫–æ–∑–∞–∫–∞: ${character.name}, ${character.race} ${character.class}`);
            
            // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω
            saveToLocalStorage();
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∫–∏–¥–∞–Ω–Ω—è 4–∫6 –∑ –≤—ñ–¥–∫–∏–¥–∞–Ω–Ω—è–º –Ω–∞–π–Ω–∏–∂—á–æ–≥–æ
        function roll4k6DropLowest() {
            let rolls = [];
            for (let i = 0; i < 4; i++) {
                rolls.push(Math.floor(Math.random() * 6) + 1);
            }
            
            // –°–æ—Ä—Ç—É—î–º–æ —Ç–∞ –≤—ñ–¥–∫–∏–¥–∞—î–º–æ –Ω–∞–π–Ω–∏–∂—á–∏–π
            rolls.sort((a, b) => a - b);
            rolls.shift();
            
            // –°—É–º—É—î–º–æ –∑–∞–ª–∏—à–µ–Ω—ñ 3
            return rolls.reduce((a, b) => a + b, 0);
        }
        
        // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–∑–∞–∫–∞ –≤ —Ä–µ—î—Å—Ç—Ä (–ª–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ)
        function saveCharacter() {
            if (!character.name.trim()) {
                showToast("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —ñ–º'—è –∫–æ–∑–∞–∫–∞ –ø–µ—Ä–µ–¥ –≤–Ω–µ—Å–µ–Ω–Ω—è–º –¥–æ —Ä–µ—î—Å—Ç—Ä—É", true);
                return;
            }
            
            saveToLocalStorage();
            
            // –ë–ª–æ–∫—É—î–º–æ —ñ–º'—è –ø—ñ—Å–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –¥–æ —Ä–µ—î—Å—Ç—Ä—É
            if (!character.nameLocked) {
                lockNameField();
            }
            
            showToast("–ö–æ–∑–∞–∫ –≤–Ω–µ—Å–µ–Ω–∏–π –¥–æ –ö–æ–∑–∞—Ü—å–∫–æ–≥–æ –†–µ—î—Å—Ç—Ä—É");
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–∑–∞–∫–∞ –∑ —Ä–µ—î—Å—Ç—Ä—É
        function loadCharacter() {
            const savedCharacter = localStorage.getItem('cossack-character');
            if (savedCharacter) {
                const parsed = JSON.parse(savedCharacter);
                character = {...character, ...parsed};
                updateFormFromCharacter();
                showToast("–ö–æ–∑–∞–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π –∑ –†–µ—î—Å—Ç—Ä—É");
            } else {
                showToast("–£ —Ä–µ—î—Å—Ç—Ä—ñ –Ω–µ–º–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –∫–æ–∑–∞–∫—ñ–≤", true);
            }
        }
        
        // –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É
        function shareCharacter() {
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ–∑–∞–∫–∞ –∑ —Ñ–æ—Ä–º–∏
            updateCharacterFromForm();
            
            // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è JSON
            const characterJson = JSON.stringify(character, null, 2);
            document.getElementById('json-output').textContent = characterJson;
            
            // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
            document.getElementById('share-modal').style.display = 'flex';
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è JSON —Ñ–∞–π–ª—É –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –æ—Ç–∞–º–∞–Ω—É
        function downloadJson() {
            updateCharacterFromForm();
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ —á–∏—Å—Ç–∏–π –æ–±'—î–∫—Ç –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É
            const exportCharacter = {
                name: character.name,
                class: character.class,
                race: character.race,
                background: character.background,
                strength: character.strength,
                dexterity: character.dexterity,
                intelligence: character.intelligence,
                wisdom: character.wisdom,
                charisma: character.charisma,
                constitution: character.constitution,
                hp: character.hp,
                maxHp: character.maxHp,
                level: character.level,
                fame: character.fame,
                inventory: character.inventory,
                skills: character.skills,
                buffs: character.buffs
            };
            
            const dataStr = JSON.stringify(exportCharacter, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `–∫–æ–∑–∞–∫-${character.name || '–Ω–µ–≤—ñ–¥–æ–º–∏–π'}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showToast("–°—É–≤—ñ–π –∑–±–µ—Ä–µ–∂–µ–Ω–æ. –ü–µ—Ä–µ–¥–∞–π—Ç–µ –π–æ–≥–æ –æ—Ç–∞–º–∞–Ω—É –ö–æ—à–∞.");
        }
        
        // –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
        function openLoadModal() {
            document.getElementById('load-modal').style.display = 'flex';
        }
        
        // –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–∑–∞–∫–∞ –∑ —Ñ–∞–π–ª—É
        function loadFromFile() {
            const fileInput = document.getElementById('file-input');
            const file = fileInput.files[0];
            
            if (!file) {
                showToast("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å —Å—É–≤—ñ–π (—Ñ–∞–π–ª)", true);
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const loadedCharacter = JSON.parse(e.target.result);
                    
                    // –û–Ω–æ–≤–ª—é—î–º–æ —Ç—ñ–ª—å–∫–∏ –æ—Å–Ω–æ–≤–Ω—ñ –ø–æ–ª—è
                    const mainFields = ['name', 'class', 'race', 'background', 'strength', 'dexterity', 'intelligence', 'wisdom', 'charisma', 'constitution', 'hp', 'maxHp', 'level', 'fame', 'inventory', 'skills', 'buffs'];
                    
                    mainFields.forEach(field => {
                        if (loadedCharacter[field] !== undefined) {
                            character[field] = loadedCharacter[field];
                        }
                    });
                    
                    // –ù–µ –±–ª–æ–∫—É—î–º–æ —ñ–º'—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∑ —Ñ–∞–π–ª—É
                    character.nameLocked = false;
                    
                    updateFormFromCharacter();
                    showToast("–ö–æ–∑–∞–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π –∑ —Å—É–≤–æ—é");
                    closeModal('load-modal');
                    
                    // –û—á–∏—â—É—î–º–æ –ø–æ–ª–µ —Ñ–∞–π–ª—É
                    fileInput.value = '';
                } catch (error) {
                    showToast("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —á–∏—Ç–∞–Ω–Ω—ñ —Å—É–≤–æ—é: –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç", true);
                }
            };
            
            reader.readAsText(file);
        }
        
        // –°–∫–∏–¥–∞–Ω–Ω—è –∫–æ–∑–∞–∫–∞
        function resetCharacter() {
            if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å—Ç–µ—Ä—Ç–∏ –∫–æ–∑–∞–∫–∞ –∑ —Ä–µ—î—Å—Ç—Ä—É? –£—Å—ñ –¥–∞–Ω—ñ –±—É–¥—É—Ç—å –≤—Ç—Ä–∞—á–µ–Ω—ñ.")) {
                character = {
                    name: "",
                    class: "",
                    race: "",
                    background: "",
                    strength: 10,
                    dexterity: 10,
                    intelligence: 10,
                    wisdom: 10,
                    charisma: 10,
                    constitution: 10,
                    hp: 45,
                    maxHp: 45,
                    level: 1,
                    fame: 0,
                    inventory: "",
                    skills: "",
                    buffs: "",
                    battleLog: [],
                    diceHistory: [],
                    nameLocked: false
                };
                
                // –î–æ–¥–∞—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –≤ –ª–æ–≥
                character.battleLog.push({
                    action: "–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω",
                    amount: character.maxHp,
                    timestamp: new Date().toLocaleTimeString(),
                    currentHp: character.maxHp
                });
                
                updateFormFromCharacter();
                
                // –†–æ–∑–±–ª–æ–∫–æ–≤—É—î–º–æ –ø–æ–ª–µ —ñ–º–µ–Ω—ñ
                const nameInput = document.getElementById('character-name');
                nameInput.readOnly = false;
                nameInput.classList.remove('locked');
                document.getElementById('name-lock').style.display = 'none';
                document.getElementById('character-final-seal').style.display = 'none';
                
                showToast("–ö–æ–∑–∞–∫ —Å—Ç–µ—Ä—Ç–∏–π –∑ —Ä–µ—î—Å—Ç—Ä—É");
                saveToLocalStorage();
            }
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–±'—î–∫—Ç–∞ –∫–æ–∑–∞–∫–∞ –∑ —Ñ–æ—Ä–º–∏
        function updateCharacterFromForm() {
            if (!character.nameLocked) {
                character.name = document.getElementById('character-name').value;
            }
            character.class = document.getElementById('character-class').value;
            character.race = document.getElementById('character-race').value;
            character.background = document.getElementById('character-background').value;
            character.inventory = document.getElementById('inventory').value;
            character.skills = document.getElementById('skills').value;
            character.buffs = document.getElementById('buffs').value;
        }
        
        // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –ª–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ
        function saveToLocalStorage() {
            updateCharacterFromForm();
            localStorage.setItem('cossack-character', JSON.stringify(character));
        }
        
        // –ü–æ–∫–∞–∑ —Ç–æ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = isError ? 
                'linear-gradient(to right, #c41e3a, #8b0000)' : 
                'linear-gradient(to right, var(--cossack-blue), #003d82)';
            toast.style.borderColor = isError ? '#8b0000' : 'var(--cossack-yellow)';
            toast.style.display = 'block';
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }
        
        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø–æ–¥—ñ–π –¥–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º–∏
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };
    </script>
</body>
</html>